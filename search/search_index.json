{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"Harden Windows Security | A New Threat to Malware   Harden Windows Safely, Securely, Only With Official Microsoft Methods  <p> Hardening Categories How To Use Features Related Trust Support Security Recommendations Resources License Wiki Basic FAQs Roadmap </p> <p></p> <p>Here are the Access Points to Other Important Pages In This Repository</p>"},{"location":"#app-control-for-business-resources","title":"App Control for Business Resources","text":""},{"location":"#appcontrol-manager-application","title":"AppControl Manager Application","text":""},{"location":"#read-the-rationale-behind-this-github-repository","title":"Read the Rationale Behind This GitHub Repository","text":"<p>Note</p> <p>Windows by default is secure and safe, this repository does not imply nor claim otherwise. Just like anything, you have to use it wisely and don't compromise yourself with reckless behavior and bad user configuration; Nothing is foolproof. This repository only uses the tools and features that have already been implemented by Microsoft in Windows OS to fine-tune it towards the highest security and locked-down state, using well-documented, supported, recommended and official methods. Continue reading for comprehensive info.</p> <p></p>"},{"location":"#how-to-use","title":"How To Use","text":""},{"location":"#install-start-harden-windows-security-using-gui-graphical-user-interface","title":"Install + Start Harden Windows Security Using GUI (Graphical User Interface)","text":"<pre><code>(irm 'https://raw.githubusercontent.com/HotCakeX/Harden-Windows-Security/main/Harden-Windows-Security.ps1')+'P'|iex\n</code></pre>"},{"location":"#or-just-install-the-harden-windows-security","title":"Or Just Install the Harden Windows Security","text":"<p>Check the Documentation for How to use and Complete Info</p>   Click/Tap here for commands  <pre><code>Install-Module -Name 'Harden-Windows-Security-Module' -Force\n</code></pre> <pre><code>Protect-WindowsSecurity -GUI # GUI Mode\n</code></pre> <pre><code>Protect-WindowsSecurity # CLI Mode\n</code></pre> <pre><code>Confirm-SystemCompliance # CLI Mode\n</code></pre> <pre><code>Unprotect-WindowsSecurity # CLI Mode\n</code></pre> <p></p> <p></p> <p></p> <p></p>"},{"location":"#install-the-appcontrol-manager","title":"Install the AppControl Manager","text":"<ul> <li>YouTube demo</li> <li>Documentation</li> </ul> <p>Use the following PowerShell command as Admin</p> <pre><code>(irm 'https://raw.githubusercontent.com/HotCakeX/Harden-Windows-Security/main/Harden-Windows-Security.ps1')+'AppControl'|iex\n</code></pre> <p></p> <p></p> <p></p> <p></p>"},{"location":"#requirements","title":"Requirements","text":"<p> PowerShell (latest version), Install it from \ud83d\udecd\ufe0f Microsoft Store or using Winget: <code>Winget install Microsoft.PowerShell</code></p> <p> Any device that meets the Windows 11 hardware and Virtualization Based Security requirements.</p> <p> Virtualization technology and Secure Boot enabled in your UEFI settings. Official guide - How to enable Secure Boot on: HP - Lenovo - Dell.</p> <p> No 3rd party AV installed.</p> <p> Latest available version of Windows installed.</p> <p>Tip</p> <p>Restart your device after applying the hardening measures.</p> <p></p> <p></p> <p></p>"},{"location":"#features","title":"Features","text":"<p> Everything always stays up-to-date with the newest proactive security measures that are industry standards and scalable.</p> <p> Everything is in clear text, nothing hidden, no 3rd party executable or pre-compiled binary is involved.</p> <p> No Windows functionality is removed/disabled against Microsoft's recommendations.</p> <p> All of the links and sources are from official Microsoft websites, straight from the source. No bias, No FUD, No misinformation and definitely No old obsolete methods. That's why there are no links to 3rd party news websites, forums, made up blogs/articles, and such.</p> With the following exceptions Link Count Link Reason 1 Intel website i7 13700k product page 1 state.gov List of State Sponsors of Terrorism 1 orpa.princeton.edu OFAC Sanctioned Countries 2 Wikipedia TLS - providing additional information 1 UK Cyber Security Centre TLS - providing additional information 1 Security.Stackexchange Q&amp;A TLS - providing additional information 1 browserleaks.com/tls TLS - Browser test 1 clienttest.ssllabs.com TLS - Browser test 1 scanigma.com/knowledge-base TLS - providing additional information 1 cloudflare.com/ssl/reference/ TLS - providing additional information 1 github.com/ssllabs/research/ TLS - providing additional information 1 Wayback Machine Providing additional information about Edge Browser <p> The module primarily uses Group policies, the Microsoft recommended way of configuring Windows. It also uses PowerShell cmdlets where Group Policies aren't available, and finally uses a few registry keys to configure security measures that can neither be configured using Group Policies nor PowerShell cmdlets. This is why the module doesn't break anything or cause unwanted behavior.</p> <p> This Readme page lists all of the security measures applied by the module.</p> <p> When a hardening measure is no longer necessary because it's applied by default by Microsoft on new builds of Windows, it will also be removed from the module in order to prevent any problems and because it won't be necessary anymore.</p> <p> The module can be run infinite number of times, it's made in a way that it won't make any duplicate changes.</p> <p> Applying these hardening measures makes your PC compliant with Microsoft Security Baselines and Secured-core PC specifications (provided that you use modern hardware that supports the latest Windows security features) - See what makes a Secured-core PC - Check Device Guard category for more info</p> <p>Secured-core \u2013 recommended for the most sensitive systems and industries like financial, healthcare, and government agencies. Builds on the previous layers and leverages advanced processor capabilities to provide protection from firmware attacks.</p> <p> Since I originally created this repository for myself and people I care about, I always maintain it to the highest possible standard.</p> <p> If you have multiple accounts on your device, you only need to apply the hardening measures 1 time with Admin privileges, that will make system-wide changes. Then you can optionally run the module, without Admin privileges, for each standard user to apply the Non-Admin category.</p> <p></p> <p>Warning</p> <p>For your own security, exercise caution when considering any other 3rd-party tools, programs, or scripts claiming to harden or modify Windows OS in any way. Verify their legitimacy thoroughly before use and after each release. Avoid blind trust in 3rd party Internet sources. Additionally, if they don't adhere to the rules mentioned above, they can cause system damage, unknown issues, and bugs.</p> <ul> <li>Read the Trust section to see how you can 100% Trust this repository.</li> <li>How are Group Policies for this module created and maintained?</li> </ul> <p></p> <p></p>"},{"location":"#hardening-categories","title":"Hardening Categories","text":"<p> From Top to bottom in order:</p> <ul> <li> <p>Commands that require Administrator Privileges (click/tap on each of these to see in-depth info)</p> <ul> <li>Microsoft Security Baselines</li> <li>Microsoft 365 Apps Security Baselines</li> <li>Microsoft Defender</li> <li>Attack surface reduction rules</li> <li>Bitlocker Settings</li> <li>Device Guard</li> <li>TLS Security</li> <li>Lock Screen</li> <li>UAC (User Account Control)</li> <li>Windows Firewall</li> <li>Optional Windows Features</li> <li>Windows Networking</li> <li>Miscellaneous Configurations</li> <li>Windows Update configurations</li> <li>Edge Browser configurations</li> <li>Certificate Checking Commands</li> <li>Country IP Blocking</li> <li>Downloads Defense Measures </li> </ul> </li> <li> <p>Commands that don't require Administrator Privileges</p> <ul> <li>Non-Admin Commands</li> </ul> </li> </ul> <p></p> <p></p> Indicator Description Security measure is applied using PowerShell cmdlets or Registry Security measure is applied using Group Policies CSP for the security measure Sub-category - prompts for additional confirmation <p></p> <p></p> <p></p>"},{"location":"#microsoft-security-baselines","title":"Microsoft Security Baselines","text":"<p> A security baseline is a group of Microsoft-recommended configuration settings that explains their security implications. These settings are based on feedback from Microsoft security engineering teams, product groups, partners, and customers.</p> <p>Continue reading in the official documentation</p> <p>Optional Overrides for Microsoft Security Baselines</p> <p></p> <p> Highly recommended to apply these overrides, the module will ask you whether you want to apply them or not. Use Optional Overrides when applying the hardening measures on Azure VMs.</p> <p></p> <p></p> <p></p>"},{"location":"#microsoft-365-apps-security-baselines","title":"Microsoft 365 Apps Security Baselines","text":"<p> The security baseline for Microsoft 365 Apps for enterprise is published twice a year, usually in June and December.</p> <p>More info in Microsoft Learn</p> <p>Microsoft Security Baselines Version Matrix</p> <p></p> <p></p> <p></p>"},{"location":"#microsoft-defender","title":"Microsoft Defender","text":"<ul> <li> <p> Extends the Cloud Security Scan time to the maximum amount of 60 seconds, by default it is 10 seconds. You need to be aware that this means actions like downloading and opening an unknown file will make Microsoft Defender send samples of it to the Cloud for more advanced analysis and it can take a maximum of 60 seconds from the time you try to open that unknown file to the time when it will be opened (if deemed safe).  CSP</p> </li> <li> <p>Here is an example of the notification you will see in Windows 11 if that happens.</p> <p><p></p></p> </li> </ul> <p></p> <ul> <li> Configures the Cloud Block/Protection Level to the maximum level of Zero Tolerance and Block At First Sight. No unknown file can run on your system without first being recognized by the Microsoft's Security Graph and other globally omniscient systems.  CSP</li> </ul> <p></p> <ul> <li> Configures the Microsoft Defender to send all samples automatically. Increasing protection by participating in the SpyNet / MAPS network.  CSP</li> </ul> <p></p> <ul> <li> Sets the SpyNet membership to Advanced, improving Cloud Protection.  CSP</li> </ul> <p></p> <ul> <li> Enables file hash computation; designed to allow admins to force the anti-malware solution to \"compute file hashes for every executable file that is scanned if it wasn't previously computed\" to \"improve blocking for custom indicators in Microsoft Defender Advanced Threat Protection (Microsoft Defender ATP).  CSP</li> </ul> <p></p> <ul> <li> <p> Clears Quarantined items after 1 day instead of the default behavior of keeping them indefinitely.  CSP</p> </li> <li> <p>Quarantine involves isolating potentially harmful files in a non-executable area of your system to prevent any risk of execution. To further minimize potential threats, quarantined files are automatically removed after 1 day, rather than being retained indefinitely. This precaution helps mitigate the possibility of these files exploiting unforeseen vulnerabilities in the future, ensuring a proactive approach to system security.</p> </li> </ul> <p></p> <ul> <li> Allows Microsoft Defender to download security updates even on a metered connection.  CSP</li> </ul> <p></p> <ul> <li> Enables Microsoft Defender to scan mapped network drives during full scan.  CSP</li> </ul> <p></p> <ul> <li> Enables Microsoft Defender to scan emails. The engine will parse the mailbox and mail files.  CSP</li> </ul> <p></p> <ul> <li> Enables Microsoft Defender to scan Removable Drives.  CSP</li> </ul> <p></p> <ul> <li> Enables Microsoft Defender to scan Reparse Points.  CSP</li> </ul> <p></p> <ul> <li> Forces Microsoft Defender to scan network files.   CSP</li> </ul> <p></p> <ul> <li> <p> Sets the Signature Update Interval to every 3 hours instead of automatically.  CSP</p> <ul> <li> <p>Change logs for security intelligence updates</p> </li> <li> <p>Configure and validate Microsoft Defender Antivirus network connections</p> </li> <li> <p>Security intelligence updates for Microsoft Defender Antivirus and other Microsoft antimalware</p> </li> <li> <p>Microsoft Safety Scanner</p> </li> <li> <p>Paste the following PowerShell code to retrieve the latest available online versions of the Platform, Signatures, and Engine for Microsoft Defender   - <pre><code>$X = irm \"https://www.microsoft.com/security/encyclopedia/adlpackages.aspx?action=info\"\n@{Engine = $X.versions.engine; Signatures = $X.versions.signatures.'#text'; Platform = $X.versions.platform} | ft -AutoSize\n</code></pre></p> </li> </ul> </li> </ul> <p></p> <ul> <li> Forces Microsoft Defender to check for new virus and spyware definitions before it runs a scan.  CSP</li> </ul> <p></p> <ul> <li> Makes Microsoft Defender run catch-up scans for scheduled quick scans. A computer can miss a scheduled scan, usually because the computer is off at the scheduled time, but now after the computer misses two scheduled quick scans, Microsoft Defender runs a catch-up scan the next time someone logs onto the computer.  CSP</li> </ul> <p></p> <ul> <li> Enables Network Protection of Microsoft Defender CSP</li> </ul> <p></p> <ul> <li> Enables scanning of restore points CSP</li> </ul> <p></p> <ul> <li> Makes sure Async Inspection for Network protection of Microsoft Defender is turned on - Network protection now has a performance optimization that allows Block mode to start asynchronously inspecting long connections after they're validated and allowed by SmartScreen, which might provide a potential reduction in the cost that inspection has on bandwidth and can also help with app compatibility problems.  CSP</li> </ul> <p></p> <ul> <li> <p>  Enables Smart App Control (if it's in Evaluation mode): adds significant protection from new and emerging threats by blocking apps that are malicious or untrusted. Smart App Control also helps to block potentially unwanted apps, which are apps that may cause your device to run slowly, display unexpected ads, offer extra software you didn't want, or do other things you don't expect.</p> <ul> <li> <p>Smart App Control is User-Mode (and enforces Kernel-Mode) App Control for Business, more info in the Wiki. You can see its status in System Information and enable it manually from Microsoft Defender app's GUI. It is very important for Windows and Windows Defender intelligence updates to be always up-to-date in order for Smart App Control to work properly as it relies on live intelligence and definition data from the cloud and other sources to make a Smart decision about programs and files it encounters.</p> </li> <li> <p>Smart App Control uses ISG (Intelligent Security Graph). The ISG isn't a \"list\" of apps. Rather, it uses the same vast security intelligence and machine learning analytics that power Microsoft Defender SmartScreen and Microsoft Defender Antivirus to help classify applications as having \"known good\", \"known bad\", or \"unknown\" reputation. This cloud-based AI is based on trillions of signals collected from Windows endpoints and other data sources and processed every 24 hours. As a result, the decision from the cloud can change.</p> </li> <li> <p>Smart App Control can block a program entirely from running or only some parts of it in which case your app or program will continue working just fine most of the time. It's improved a lot since it was introduced, and it continues doing so. Consider turning it on after clean installing a new OS and fully updating it.</p> </li> <li> <p>Smart App Control enforces the Microsoft Recommended Driver Block rules and the Microsoft Recommended Block Rules</p> </li> <li> <p>Once you turn Smart App Control off, it can't be turned on without resetting or reinstalling Windows.</p> </li> </ul> </li> </ul> <p></p> <ul> <li>  Enables \"Send optional diagnostic data\" because it is required for Smart App Control to operate when it's in evaluation mode or turned on, and for communication with Intelligent Security Graph (ISG). This setting will be automatically applied if Smart App Control is already turned on or you choose to turn it on.  CSP</li> </ul> <p></p> <ul> <li> <p> Enables Controlled Folder Access. It helps protect your valuable data from malicious apps and threats, such as ransomware. Controlled folder access protects your data by checking apps against a list of known, trusted apps. Due to the recent wave of global ransomware attacks, it is important to use this feature to protect your valuables files, specially OneDrive folders.  CSP</p> <ul> <li> <p>If it blocks a program from accessing one of your folders it protects, and you absolutely trust that program, then you can add it to exclusion list using Microsoft Defender GUI or PowerShell. you can also query the list of allowed apps using PowerShell (commands below). with these commands, you can backup your personalized list of allowed apps, that are relevant to your system, and restore them in case you clean install your Windows.</p> </li> <li> <p> The root of the OneDrive folders of all the user accounts will be added to the protected folders list of Controlled Folder Access, to provide Ransomware protection for the entire OneDrive folder.  CSP</p> </li> </ul> <pre><code># Add multiple programs to the exclusion list of Controlled Folder Access\nAdd-MpPreference -ControlledFolderAccessAllowedApplications 'C:\\Program Files\\App\\app.exe','C:\\Program Files\\App2\\app2.exe'\n</code></pre> <pre><code># Get the list of all allowed apps\n(Get-MpPreference).ControlledFolderAccessAllowedApplications\n</code></pre> </li> </ul> <p></p> <ul> <li> <p> Enables Mandatory ASLR, It might cause compatibility issues only for some poorly-made 3rd party programs, specially portable ones.  CSP</p> <ul> <li> <p>Automatically detects and excludes the Git executables of GitHub Desktop and Git (Standalone version) from mandatory ASLR if they are installed on the system. More info here</p> </li> <li> <p>You can add Mandatory ASLR override for a trusted program using the PowerShell command below or in the Program Settings section of Exploit Protection in Microsoft Defender app.</p> <ul> <li><code>Set-ProcessMitigation -Name \"C:\\TrustedApp.exe\" -Disable ForceRelocateImages</code></li> </ul> </li> </ul> </li> </ul> <p></p> <ul> <li> <p> Applies Exploit Protections/Process Mitigations from this list to the following programs:  CSP</p> <ul> <li> <p>All channels of Microsoft Edge browser</p> </li> <li> <p>Quick Assist app</p> </li> <li> <p>Some System processes</p> </li> <li> <p>Microsoft 365 apps</p> </li> <li> <p>More apps and processes will be added to the list over time once they are properly validated to be fully compatible.</p> </li> <li> <p>Exploit Protection configurations are also accessible in XML format within this repository. When implementing exploit protections using an XML file, the existing exploit mitigations will seamlessly integrate rather than being overwritten. Should there be pre-existing exploit protections applied to an executable on the system, and the XML file specifies different mitigations for the same executable, these protections will be merged and applied collectively.</p> </li> </ul> </li> </ul> <p></p> <ul> <li> Turns on Data Execution Prevention (DEP) for all applications, including 32-bit programs. By default, the output of <code>BCDEdit /enum \"{current}\"</code> (in PowerShell) for the NX bit is <code>OptIn</code> but this module sets it to <code>AlwaysOn</code></li> </ul> <p></p> <ul> <li> Check for the latest virus and spyware security intelligence on startup.  CSP</li> </ul> <p></p> <ul> <li> Specifies the maximum depth to scan archive files to the maximum possible value of <code>4,294,967,295</code> CSP</li> </ul> <p></p> <ul> <li> Defines the maximum size of downloaded files and attachments to be scanned and set it to the maximum possible value of <code>10,000,000 KB</code> or <code>10 GB</code>. the default is <code>20480 KB</code> or <code>~20MB</code> CSP</li> </ul> <p></p> <ul> <li> Enables the Enhanced Phishing Protection service.  CSP</li> </ul> <p></p> <ul> <li> Enables notifying user of malicious and phishing scenarios in Microsoft Defender Enhanced Phishing Protection.  CSP</li> </ul> <p></p> <ul> <li> Enables the feature in Enhanced Phishing Protection in Microsoft Defender SmartScreen that warns users if they reuse their work or school password.  CSP</li> </ul> <p></p> <ul> <li> Enables warning users if they type their work or school passwords in unsafe apps.  CSP</li> </ul> <p></p> <ul> <li> Enables automatic data collection (formerly known as Capture Threat Window) of Enhanced Phishing Protection in Microsoft Defender SmartScreen for security analysis from a suspicious website or app.  CSP</li> </ul> <p></p> <ul> <li> Creates scheduled task for fast weekly Microsoft recommended driver block list update.. You won't see this prompt if the task already exists and is enabled or running.</li> </ul> <p></p> <ul> <li>  Set Microsoft Defender engine and platform update channel to beta.  CSP CSP</li> </ul> <p></p> <ul> <li> Defines the number of days before spyware security intelligence is considered out of date to 2. The default is 7.  CSP</li> </ul> <p></p> <ul> <li> Defines the number of days before virus security intelligence is considered out of date to 2. The default is 7.  CSP</li> </ul> <p></p> <ul> <li> Sets the default action for Severe and High threat levels to Remove, for Medium and Low threat levels to Quarantine.  CSP</li> </ul> <p></p> <ul> <li> Configures real-time protection and Security Intelligence Updates to be enabled during OOBE.  CSP</li> </ul> <p></p> <ul> <li> Enables the Intel TDT (Intel\u00ae Threat Detection Technology) integration with Microsoft Defender.  CSP</li> </ul> <p></p> <ul> <li> Disables Performance Mode - Security risks in relation to Dev Drive CSP</li> </ul> <p></p> <ul> <li> Enables a network protection setting that blocks malicious network traffic instead of displaying a warning.  CSP</li> </ul> <p></p> <ul> <li> Configures the Brute-Force Protection to use cloud aggregation to block IP addresses that are over 99% likely malicious  CSP</li> </ul> <p></p> <ul> <li> Configures the Brute-Force Protection to detect and block attempts to forcibly sign in and initiate sessions  CSP</li> </ul> <p></p> <ul> <li> Sets the internal feature logic to determine blocking time for the Brute-Force Protections  CSP</li> </ul> <p></p> <ul> <li> Configures the Remote Encryption Protection to use cloud intel and context, and block when confidence level is above 90%.  CSP</li> </ul> <p></p> <ul> <li> Configures the Remote Encryption Protection to detect and block attempts to replace local files with encrypted versions from another device  CSP</li> </ul> <p></p> <ul> <li> Sets the internal feature logic to determine blocking time for the Remote Encryption Protection  CSP</li> </ul> <p></p> <ul> <li> Extends the brute-force protection coverage in the Microsoft Defender Antivirus to block local network addresses.  CSP</li> </ul> <p></p> <ul> <li> Enables ECS Configurations in the Microsoft Defender. They improve product health and security by automatically fixing any possible issues/bugs that may arise, in a timely manner.</li> </ul> <p></p> <ul> <li> Enables Network Protection to be configured into block or audit mode on Windows Server.  CSP</li> </ul> <p></p> <p>Tip</p> <p>Performance analyzer for Microsoft Defender Antivirus</p> <p></p> <p></p> <p></p>"},{"location":"#attack-surface-reduction-rules","title":"Attack surface reduction rules","text":"<p> Attack surface reduction rules target certain software behaviors, such as:  CSP</p> <ul> <li>Launching executable files and scripts that attempt to download or run files</li> <li>Running obfuscated or otherwise suspicious scripts</li> <li>Performing behaviors that apps don't usually initiate during normal day-to-day work</li> </ul> <p>Such software behaviors are sometimes seen in legitimate applications. However, these behaviors are often considered risky because they are commonly abused by attackers through malware. Attack surface reduction rules can constrain software-based risky behaviors and help keep your organization safe.</p> <p>Reducing your attack surface means protecting your devices and network, which leaves attackers with fewer ways to perform attacks. Configuring attack surface reduction rules in Windows can help!</p> <p>Tip</p> <p>all 19 available Attack Surface Reduction rules shown in the official chart will be enabled. The Harden Windows Security application also allows you to individually configure each Attack Surface Reduction rule.</p> <p></p> <p></p> <p></p>"},{"location":"#bitlocker-settings","title":"Bitlocker Settings","text":"<ul> <li> <p> The module sets up and configures Bitlocker using official documentation, with the most secure configuration and military grade encryption algorithm, XTS-AES-256, to protect the confidentiality and integrity of all information at rest.  CSP CSP</p> <ul> <li> <p>It offers 2 security levels for OS drive encryption: Enhanced and Normal.</p> </li> <li> <p>In Normal security level, the OS drive is encrypted with TPM and Startup PIN. This provides very high security for your data, specially with a PIN that's long, complicated (uppercase and lowercase letters, symbols, numbers, spaces) and isn't the same as your Windows Hello PIN.</p> </li> <li> <p>In Enhanced security level, the OS drive is encrypted with TPM and Startup PIN and Startup key. This provides the highest level of protection by offering Multifactor Authentication. You will need to enter your PIN and also plug in a flash drive, containing a special BitLocker key, into your device in order to unlock it. Continue reading more about it here.</p> </li> <li> <p>Once the OS drive is encrypted, for every other non-OS drive, there will be prompts for confirmation before encrypting it. The encryption will use the same algorithm as the OS drive and uses Auto-unlock key protector. Removable flash drives are skipped.</p> </li> <li> <p>The recovery information of all of the drives are saved in a single well-formatted text file in the root of the OS drive <code>C:\\BitLocker-Recovery-Info-All-Drives.txt</code>. It's very important to keep it in a safe and reachable place as soon as possible, e.g., in OneDrive's Personal Vault which requires additional authentication to access. See here and here for more info. You can use it to unlock your drives if you ever forget your PIN, lose your Startup key (USB Flash Drive) or TPM no longer has the correct authorization (E.g., after a firmware change).</p> </li> <li> <p>TPM has special anti-hammering logic which prevents malicious user from guessing the authorization data indefinitely. Microsoft defines that maximum number of failed attempts in Windows is 32 and every single failed attempt is forgotten after 2 hours. This means that every continuous two hours of powered on (and successfully booted) operation without an event which increases the counter will cause the counter to decrease by 1. You can view all the details using this PowerShell command: <code>Get-TPM</code>.</p> </li> <li> <p>Check out Lock Screen category for more info about the recovery password and the 2nd anti-hammering mechanism.</p> </li> <li> <p>BitLocker will bring you a real security against the theft of your device if you strictly abide by the following basic rules:</p> <ul> <li> <p>As soon as you have finished working, either Hibernate or shut Windows down and allow for every shadow of information to disappear from RAM within 2 minutes. This practice is recommended in High-Risk Environments.</p> </li> <li> <p>Do not mix 3rd party encryption software and tools with Bitlocker. Bitlocker creates a secure end-to-end encrypted ecosystem for your device and its peripherals, this secure ecosystem is backed by things such as software, Virtualization Technology, TPM 2.0 and UEFI firmware, Bitlocker protects your data and entire device against real-life attacks and threats. You can encrypt your external SSDs and flash drives with Bitlocker too.</p> </li> </ul> </li> </ul> </li> </ul> <p></p> <p>Important</p> <p>AMD Zen 2 and 3 CPUs have a vulnerability in them, if you use one of them, make sure your Bitlocker Startup PIN is at least 16 characters long (max is 20).</p> <p></p> <ul> <li> <p> Enables or disables DMA protection from Bitlocker Countermeasures based on the status of Kernel DMA protection. Kernel DMA Protection is not compatible with other BitLocker DMA attacks countermeasures. It is recommended to disable the BitLocker DMA attacks countermeasures if the system supports Kernel DMA Protection (this module does that exactly). Kernel DMA Protection provides higher security bar for the system over the BitLocker DMA attack countermeasures, while maintaining usability of external peripherals. you can check the status of Kernel DMA protection using this official guide.  CSP</p> <ul> <li>Kernel DMA Protection (Memory Access Protection) for OEMs page shows the requirements for Kernel DMA Protection. for Intel CPUs, support for requirements such as VT-X and VT-D can be found in each CPU's respective product page. e.g. Intel i7 13700K</li> </ul> </li> </ul> <p></p> <ul> <li> Disallows standard (non-Administrator) users from changing the Bitlocker Startup PIN or password  CSP</li> </ul> <p></p> <ul> <li> Requires you to choose a PIN that contains at least 10 characters CSP</li> </ul> <p></p> <ul> <li> <p> (Only on Physical machines) Enables Hibernate and adds Hibernate to Start menu's power options.  CSP</p> <ul> <li>Devices that support Modern Standby have the most security because (S1-S3) power states which belong to the legacy sleep modes are not available. In Modern Standby, security components remain vigilant and the OS stays protected. Applying Microsoft Security Baselines also automatically disables the legacy (S1-S3) sleep states.</li> </ul> </li> </ul> <p></p> <ul> <li> sets Hibernate to full</li> </ul> <p></p> <ul> <li> Enables network connectivity in standby on modern standby-capable systems. This ensures security updates for Microsoft Defender and Windows will be installed automatically.  CSP</li> </ul> <p></p> <ul> <li> Disallows access to Bitlocker-protected removable data drives from earlier versions of Windows.</li> </ul> <p>Refer to this official documentation about the countermeasures of Bitlocker</p> <p></p> <p></p> <p></p>"},{"location":"#device-guard","title":"Device Guard","text":"<ul> <li> <p> Virtualization-Based Security + UEFI Lock CSP</p> <ul> <li>Validate enabled Windows Defender Device Guard hardware-based security features</li> </ul> </li> </ul> <p></p> <ul> <li> <p> Secure boot (without requiring DMA protection) for Virtualization-Based Security CSP</p> <ul> <li> <p>This is in accordance with Microsoft's recommendation. This option provides Secure Boot with as much protection as is supported by a given computer\u2019s hardware. A computer with input/output memory management units (IOMMUs) will have Secure Boot with DMA protection. A computer without IOMMUs will simply have Secure Boot enabled.</p> </li> <li> <p>Secure boot has 2 parts, part 1 is enforced using the Group Policy by this module, but for part 2, you need to enable Secure Boot in your UEFI firmware settings if it's not enabled by default (which is the case on older hardware).</p> </li> <li> <p>(Kernel) DMA protection hardware requirements</p> </li> </ul> </li> </ul> <p></p> <ul> <li> Virtualization-based protection of Code Integrity + UEFI Lock  CSP</li> </ul> <p></p> <ul> <li> Require UEFI Memory Attributes Table (MAT) CSP</li> </ul> <p></p> <ul> <li> <p> Windows Defender Credential Guard + UEFI Lock CSP</p> <ul> <li> <p>Windows Defender Device Guard and Windows Defender Credential Guard hardware readiness tool</p> </li> <li> <p>Windows Defender Credential Guard requirements</p> </li> </ul> </li> </ul> <p></p> <ul> <li> <p> System Guard Secure Launch and SMM protection (Firmware Protection) CSP</p> <ul> <li>How to verify System Guard Secure Launch is configured and running</li> </ul> </li> </ul> <p></p> <ul> <li> Kernel Mode Hardware Enforced Stack Protection</li> </ul> <p></p> <ul> <li> Local Security Authority (LSA) process Protection + UEFI Lock  CSP</li> </ul> <p></p> <ul> <li> Enables Machine Identity Isolation Configuration in Enforcement mode.</li> </ul> <p></p> <ul> <li> <p>  Enables Virtualization-based Security and Memory Integrity in Mandatory mode.</p> </li> <li> <p>Special care should be used before enabling this mode, since, in case of any failure of the virtualization modules, the system will refuse to boot.</p> </li> </ul> <p></p> <p>Tip</p> <p>Most of the Device Guard and Virtualization-Based Security features are Automatically enabled by default on capable and modern hardware. The rest of them will be enabled and configured to the most secure state after you apply the Microsoft Security Baselines and the Harden Windows Security policies.</p> <ul> <li> <p>Check out Secured-Core PC requirements.</p> </li> <li> <p>Memory integrity and VBS enablement</p> </li> </ul> <p></p> <p>Important</p> <p>About UEFI Lock</p> <p>UEFI locked security measures are rooted in Proof of Physical Presence and they can't be disabled by modifying Group Policy, registry keys or other Administrative tasks. The only way to disable UEFI locked security measures is to have physical access to the computer, reboot and access the UEFI settings, supply the credentials to access the UEFI, turn off Secure Boot, reboot the system and then you will be able to disable those security measures with Administrator privileges.</p> <p></p> <p>Note</p> <p>Device Protection in Windows Security Gives You One of These 4 Hardware Scores</p> <p><ol> <li>Standard hardware security not supported</li> <ul> <li>This means that your device does not meet at least one of the requirements of Standard Hardware Security.</li> </ul> <li>Your device meets the requirements for Standard Hardware Security. </li> <ul> <li>TPM 2.0</li> <li>Secure boot</li> <li>DEP</li> <li>UEFI MAT</li> </ul> <li>Your device meets the requirements for Enhanced Hardware Security</li> <ul> <li>TPM 2.0</li> <li>Secure boot</li> <li>DEP</li> <li>UEFI MAT</li> <li>Memory Integrity</li> </ul> <li>Your device has all Secured-core PC features enabled</li> <ul> <li>TPM 2.0</li> <li>Secure boot</li> <li>DEP</li> <li>UEFI MAT</li> <li>Memory Integrity</li> <li>System Management Mode (SMM)</li> </ul> </ol></p> <p></p> <p></p> <p></p>"},{"location":"#tls-security","title":"TLS Security","text":"<p>Changes made by this category only affect things that use Schannel SSP: that includes IIS web server, built-in inbox Windows apps and some other programs supplied by Microsoft, including Windows network communications, but not 3rd party software that use portable stacks like Java, nodejs, python or php.</p> <p>If you want to read more: Demystifying Schannel</p> <p></p> <ul> <li> Disables TLS 1 and TLS 1.1 security protocols that only exist for backward compatibility. All modern software should and do use <code>TLS 1.2</code> and <code>TLS 1.3</code>.  CSP CSP</li> </ul> <p></p> <ul> <li> Disables MD5 Hashing Algorithm that is only available for backward compatibility</li> </ul> <p></p> <ul> <li> Disables the following weak ciphers that are only available for backward compatibility: <code>\"DES 56-bit\"</code>,<code>\"RC2 40-bit\"</code>,<code>\"RC2 56-bit\"</code>,<code>\"RC2 128-bit\"</code>,<code>\"RC4 40-bit\"</code>,<code>\"RC4 56-bit\"</code>,<code>\"RC4 64-bit\"</code>,<code>\"RC4 128-bit\"</code>,<code>\"3DES 168-bit (Triple DES 168)\"</code></li> </ul> <p></p> <ul> <li> Configures the TLS to only use the following secure cipher suites and in this exact order:  CSP</li> </ul> <pre><code>TLS_CHACHA20_POLY1305_SHA256\nTLS_AES_256_GCM_SHA384\nTLS_AES_128_GCM_SHA256\nTLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\nTLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\nTLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\nTLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\nTLS_DHE_RSA_WITH_AES_256_GCM_SHA384\nTLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n</code></pre> <p></p> <ul> <li>  Use the TLS for BattleNet sub-category if you have the BattleNet game client installed on your system. This client utilizes the <code>TLS_RSA_WITH_AES_256_CBC_SHA</code> cipher suite to establish connections with its servers. Since this cipher suite is less secure, it is excluded from the secure cipher-suites list by default. However, enabling this sub-category will include the required cipher suite, allowing you to use BattleNet without interruptions.</li> </ul> <p></p> <ul> <li> Configures TLS ECC Curves to use the following prioritized Curves order:  CSP</li> </ul> <pre><code>nistP521\ncurve25519\nNistP384\nNistP256\n</code></pre> <ul> <li>By default, in Windows, the order is this:</li> </ul> <pre><code>curve25519\nNistP256\nNistP384\n</code></pre> <p>Read more in this Wiki post</p> <p></p> <p></p> <p></p>"},{"location":"#lock-screen","title":"Lock Screen","text":"<ul> <li> Automatically locks device after X seconds of inactivity (just like mobile phones), which is set to 120 seconds (2 minutes) in this module, you can change that to any value you like.  CSP</li> </ul> <ul> <li> <p> Requires CTRL+ALT+DEL on the lock screen, kernel protected set of key strokes. The reason and logic behind it is:  CSP</p> <ul> <li>A malicious user might install malware that looks like the standard sign-in dialog box for the Windows operating system and capture a user's password. The attacker can then sign into the compromised account with whatever level of user rights that user has.</li> </ul> </li> </ul> <p></p> <ul> <li> <p> Enables a security anti-hammering feature that sets a threshold of 5 for the number of failed sign-in attempts that causes the device to be locked by using BitLocker. Sign-in attempts include Windows password or Windows Hello authentication methods. This threshold means, if the specified maximum number of failed sign-in attempts is exceeded, the device will invalidate the Trusted Platform Module (TPM) protector and any other protector except the 48-digit recovery password, and then reboot. During Device Lockout mode, the computer or device only boots into the touch-enabled Windows Recovery Environment (WinRE) until an authorized user enters the recovery password to restore full access.</p> <ul> <li>This module (in the Bitlocker category) automatically saves the 48-digit recovery password of each drive in itself, the location of it will also be visible on the PowerShell console when you run it. It is very important to keep it in a safe and reachable place, e.g. in OneDrive's Personal Vault which requires authentication to access. See Here and Here for more info about OneDrive's Personal Vault</li> </ul> </li> </ul> <p></p> <ul> <li> Configures account lockout policy: Account lockout threshold, Sets the number of allowed failed sign-in attempts to 5. In combination with other policies in this category, this means every 5 failed sign-in attempts will need a full day to pass before 5 more attempts can be made, otherwise Bitlocker will engage, system will be restarted and 48-digit Bitlocker code will be asked. This policy greatly prevents brute force attempts. CSP</li> </ul> <p></p> <ul> <li> Configures account lockout policy: Sets Account lockout duration to 1440 minutes or 1 day. In combination with other policies in this category, this means every 5 failed sign-in attempts will need a full day to pass before 5 more attempts can be made, otherwise Bitlocker will engage, system will be restarted and 48-digit Bitlocker code will be asked.  CSP</li> </ul> <p></p> <ul> <li> Configures account lockout policy: Sets Reset account lockout counter to 1440 minutes or 1 day. In combination with other policies in this category, this means every 5 failed sign-in attempts will need a full day to pass before 5 more attempts can be made, otherwise Bitlocker will engage, system will be restarted and 48-digit Bitlocker code will be asked.  CSP</li> </ul> <p></p> <ul> <li> Hides email address of the Microsoft account on lock screen, if your device is in a trusted place like at home then this isn't necessary.</li> </ul> <p></p> <ul> <li> <p> Don't display username at sign-in; If a user signs in as Other user, the full name of the user isn't displayed during sign-in. In the same context, if users type their email address and password at the sign-in screen and press Enter, the displayed text \"Other user\" remains unchanged, and is no longer replaced by the user's first and last name, as in previous versions of Windows 10. Additionally, if users enter their domain user name and password and click Submit, their full name isn't shown until the Start screen displays.  CSP</p> <ul> <li>Useful If you have devices that store sensitive data, with monitors displayed in unsecured locations, or if you have devices with sensitive data that are remotely accessed, revealing logged on user's full names or domain account names</li> </ul> </li> </ul> <p></p> <ul> <li> <p> Don't display last signed-in; This security policy setting determines whether the name of the last user to sign in to the device is displayed on the Secure Desktop. If this policy is enabled, the full name of the last user to successfully sign in isn't displayed on the Secure Desktop, nor is the user's sign-in tile displayed. Additionally, if the Switch user feature is used, the full name and sign-in tile aren't displayed. The sign-in screen requests both Username + Windows Hello credentials.  CSP</p> <ul> <li> <p>This feature can be useful to enable if you live in High-Risk Environments and you don't want anyone to get any information about your accounts when you aren't logged-in.</p> </li> <li> <p>This policy will prevent you from using \"Forgot my PIN\" feature in lock screen or logon screen. If you forget your PIN, you won't be able to recover it.</p> </li> <li> <p>If you use Windows Hello Face or Fingerprint, you can easily login using those credential providers without the need to supply username first.</p> </li> </ul> </li> </ul> <p></p> <ul> <li> Don't Display Network Selection UI on Lock Screen (like WIFI Icon); This setting allows you to control whether anyone can interact with available networks UI on the logon screen. Once enabled, the device's network connectivity state cannot be changed without signing into Windows. Suitable for High-Risk Environments.  CSP</li> </ul> <p></p> <ul> <li> <p> Applies the following PIN Complexity rules to Windows Hello  CSP. Please note that, by default, any character can be set as a PIN. However, the following policies ensure that certain characters are always included as a minimum requirement.</p> <ul> <li> <p>Must include digits CSP</p> </li> <li> <p>Expires every 180 days (default behavior is to never expire)  CSP</p> </li> <li> <p>Setting an expiration date ensures that, in the event of theft, a threat actor cannot indefinitely attempt to guess the PIN. After 180 days, the PIN expires, rendering it unusable even if guessed correctly. To reset the PIN, authentication via a Microsoft account or EntraID\u2014likely inaccessible to the attacker\u2014will be required. Combined with anti-hammering and BitLocker policies, this expiration guarantees that a threat actor cannot endlessly persist in guessing the PIN.</p> </li> <li> <p>History of the 1 most recent selected PIN is preserved to prevent the user from reusing it  CSP</p> </li> <li> <p>Must include lower-case letters CSP</p> </li> </ul> </li> </ul> <p></p> <p></p> <p></p>"},{"location":"#user-account-control","title":"User Account Control","text":"<ul> <li> <p> Prompt for elevation of privilege on secure desktop for all binaries in Administrator accounts, which presents the sign-in UI and restricts functionality and access to the system until the sign-in requirements are satisfied. The secure desktop's primary difference from the user desktop is that only trusted processes running as SYSTEM are allowed to run here (that is, nothing is running at the user's privilege level). The path to get to the secure desktop from the user desktop must also be trusted through the entire chain.  CSP</p> <ul> <li> <p>Default Behavior: Prompt for consent for non-Windows binaries: When an operation for a non-Microsoft application requires elevation of privilege, the user is prompted on the secure desktop to select either Permit or Deny. If the user selects Permit, the operation continues with the user's highest available privilege.</p> </li> <li> <p>Harden Windows Security Behavior: When an operation requires elevation of privilege, the user is prompted on the secure desktop to select either Permit or Deny. If the user selects Permit, the operation continues with the user's highest available privilege.</p> </li> </ul> </li> </ul> <p></p> <ul> <li>  Only elevate executables that are signed and validated by enforcing cryptographic signatures on any interactive application that requests elevation of privilege. One of the Potential impacts of it is that it can prevent certain poorly designed programs from prompting for UAC.  CSP</li> </ul> <p></p> <ul> <li> <p>  Hides the entry points for Fast User Switching.  CSP</p> <ul> <li>This policy will prevent you from using \"Forgot my PIN\" feature in lock screen or logon screen. If you forget your PIN, you won't be able to recover it.</li> </ul> </li> </ul> <p></p> <ul> <li> Sets the behavior of the elevation prompt for Standard users to Prompt for Credentials on the Secure Desktop.  CSP</li> </ul> <p></p> <ul> <li> Configures the type of Admin Approval Mode to be Admin Approval Mode with enhanced privilege protection.</li> </ul> <p></p> <p></p> <p></p>"},{"location":"#windows-firewall","title":"Windows Firewall","text":"<ul> <li> Sets the Network Location of all connections to Public; Public network means less trust to other network devices.</li> </ul> <ul> <li> Makes sure Windows Firewall is enabled for all profiles (which is the default)  CSP CSP CSP</li> </ul> <ul> <li> Sets inbound and outbound default actions for Domain Firewall Profile to Block; because this module is Not intended to be used on devices that are part of a domain or controlled by an Active Directory Domain Controller, since they will have their own policies and policy management systems in place.  CSP CSP</li> </ul> <ul> <li> Enables Windows Firewall logging for Domain, Private and Public profiles, sets the log file size for each of them to the max <code>32.767 MB</code>. Defines separate log files for each of the firewall profiles. Logs only dropped packets for Private and Public profiles, Logs both dropped and successful packets for Domain profile.  CSP CSP CSP CSP CSP CSP CSP CSP CSP</li> </ul> <ul> <li> Disables Multicast DNS (mDNS) UDP-in Firewall Rules for all 3 Firewall profiles, This might interfere with Miracast screen sharing, which relies on the Public profile, and homes where the Private profile is not selected, but it does add an extra measure of security in public places, like a coffee shop.<ul> <li>The domain name <code>.local</code> which is used in mDNS (Multicast DNS) is a special-use domain name reserved by the Internet Engineering Task Force (IETF) so that it may not be installed as a top-level domain in the Domain Name System (DNS) of the Internet.</li> </ul> </li> </ul>"},{"location":"#optional-windows-features","title":"Optional Windows Features","text":"<ul> <li> <p> The module disables the following rarely used features in Windows optional features (Control Panel):</p> <ul> <li> <p>PowerShell v2: because it's old and doesn't support AMSI.</p> </li> <li> <p>Work Folders client: not used when your computer is not part of a domain or enterprise network.</p> </li> <li> <p>Internet Printing Client: used in combination with IIS web server, old feature, can be disabled without causing problems further down the road.</p> </li> <li> <p>Windows Media Player (legacy): isn't needed anymore, Windows 11 has a modern media player app.</p> </li> <li> <p>Microsoft Defender Application Guard, it's deprecated. Learn more about Microsoft Edge Security Features here.</p> </li> </ul> </li> </ul> <p></p> <ul> <li> <p> Uninstalls these optional features (Windows Settings -&gt; Apps -&gt; Optional Features):</p> <ul> <li> <p>Notepad (system): legacy Notepad program. Windows 11 has multi-tabbed modern Notepad app.</p> </li> <li> <p>VBSCRIPT: a legacy deprecated scripting engine component, Microsoft does not recommend using this component unless and until it is really required.</p> </li> <li> <p>Internet Explorer mode for Edge browser: It's only used by a few possible organizations that have very old internal websites.</p> </li> <li> <p>WMIC: Old and deprecated, not secure and is in Microsoft recommended block rules.</p> </li> <li> <p>WordPad: Old and deprecated. None of the new features of Word documents are supported in it. Recommended to use Word Online, Notepad or M365 Word.</p> </li> <li> <p>PowerShell ISE: Old PowerShell environment that doesn't support versions above 5.1. Highly recommended to use Visual Studio Code for PowerShell usage and learning. You can even replicate the ISE experience in Visual Studio Code. You can access Visual Studio Code online in your browser without the need to install anything.</p> </li> <li> <p>Steps Recorder: it's deprecated.</p> </li> </ul> </li> </ul> <p></p> <ul> <li> <p> Enables these optional features (Control Panel):</p> <ul> <li> <p>Windows Sandbox: install, test and use programs in a disposable virtual operation system, completely separate from your  main OS</p> </li> <li> <p>Hyper-V: a great hybrid hypervisor (Type 1 and Type 2) to run virtual machines on. check out this Hyper-V Wiki page</p> </li> </ul> </li> </ul> <p></p> <p></p> <p></p>"},{"location":"#windows-networking","title":"Windows Networking","text":"<ul> <li> Disables NetBIOS over TCP/IP on all network interfaces.</li> </ul> <ul> <li> Disables Smart Multi-Homed Name Resolution because it uses NetBIOS and LLMNR, protocols that shouldn't be used anymore.  CSP</li> </ul> <ul> <li> Disables LMHOSTS lookup protocol on all network adapters, legacy feature that's not used anymore.</li> </ul> <ul> <li> Disables Printing over HTTP because HTTP is not encrypted and it's an old feature that's not used anymore.  CSP</li> </ul> <ul> <li> Clears all the entries in Remotely accessible registry paths.</li> </ul> <ul> <li> Clears all the entries in Remotely accessible registry paths and subpaths.</li> </ul> <ul> <li> Sets the minimum required SMB version for Client to <code>3.1.1</code> which is the latest available version at the moment and was introduced years ago with Windows 10.</li> </ul> <ul> <li> Sets the minimum required SMB version for Server to <code>3.1.1</code> which is the latest available version at the moment and was introduced years ago with Windows 10.</li> </ul> <ul> <li> Blocks NTLM completely for SMB.</li> </ul> <ul> <li> Requires encryption for SMB client/workstation.</li> </ul> <ul> <li> Enables encryption for SMB Server. Its status can be checked using the following PowerShell command: <code>(get-SmbServerConfiguration).EncryptData</code>. If the returned value is <code>$True</code> then SMB Encryption is turned on.</li> </ul> <ul> <li> Enables QUIC for SMB Client.</li> </ul> <ul> <li> Enables QUIC for SMB Server.</li> </ul> <ul> <li> Configures the Cipher Suites from the default value of <code>AES_128_GCM,AES_128_CCM,AES_256_GCM,AES_256_CCM</code> to <code>AES_256_GCM,AES_256_CCM,AES_128_GCM,AES_128_CCM</code> for the SMB Client.  CSP</li> </ul> <ul> <li> Configures the Cipher Suites from the default value of <code>AES_128_GCM,AES_128_CCM,AES_256_GCM,AES_256_CCM</code> to <code>AES_256_GCM,AES_256_CCM,AES_128_GCM,AES_128_CCM</code> for the SMB Server.  CSP</li> </ul>"},{"location":"#miscellaneous-configurations","title":"Miscellaneous Configurations","text":"<ul> <li> <p> Sets Early launch antimalware engine's status to <code>8</code> which is Good only. The default value is <code>3</code>, which allows good, unknown and 'bad but critical'. that is the default value, because setting it to <code>8</code> can prevent your computer from booting if the driver it relies on is critical but at the same time unknown or bad.  CSP</p> <ul> <li>By being launched first by the kernel, ELAM is ensured to be launched before any third-party software and is therefore able to detect malware in the boot process and prevent it from initializing. ELAM drivers must be specially signed by Microsoft to ensure they are started by the Windows kernel early in the boot process.</li> </ul> </li> </ul> <p></p> <ul> <li> Disables location services (Location, Windows Location Provider, Location Scripting) system wide. Websites and apps won't be able to use your precise location, however they will still be able to detect your location using your IP address.  CSP CSP CSP</li> </ul> <p></p> <ul> <li> <p> Enables <code>svchost.exe</code> mitigations. built-in system services hosted in <code>svchost.exe</code> processes will have stricter security policies enabled on them. These stricter security policies include a policy requiring all binaries loaded in these processes to be signed by Microsoft, and a policy disallowing dynamically generated code.  CSP</p> <ul> <li>Requires Business Windows licenses. e.g., Windows 11 pro for Workstations, Enterprise or Education.</li> </ul> </li> </ul> <p></p> <ul> <li> Turns on Enhanced mode search for Windows indexer. The default is classic mode.  CSP<ul> <li>This causes some UI elements in the search settings in Windows settings to become unavailable for Standard user accounts to view, because it will be a managed feature by an Administrator.</li> </ul> </li> </ul> <p></p> <ul> <li> Enforce the Administrator role for adding printer drivers CSP</li> </ul> <p></p> <ul> <li> Enables SMB/LDAP Signing CSP CSP</li> </ul> <p></p> <ul> <li> Enables Edge browser (stable/beta/dev channels) to download and install updates on any network, metered or not; because the updates are important and should not be suppressed.</li> </ul> <p></p> <ul> <li> Enables all Windows users to use Hyper-V and Windows Sandbox by adding all Windows users to the \"Hyper-V Administrators\" security group using its SID. By default, only Administrators can use Hyper-V or Windows Sandbox.</li> </ul> <p></p> <ul> <li> <p> Creates custom views for Windows Event Viewer to help keep tabs on important security events:</p> <ul> <li> <p>Attack Surface Reduction Rules</p> </li> <li> <p>Controlled Folder Access</p> </li> <li> <p>Exploit Protection</p> </li> <li> <p>Network Protection</p> </li> <li> <p>MSI and Scripts for App Control Auditing</p> </li> <li> <p>Sudden Shut down events (due to power outage)</p> </li> <li> <p>Code Integrity Operational</p> </li> <li> <p>Restarts (By user or by the System/Apps)</p> </li> <li> <p>Workstation Locks and Unlocks</p> </li> <li> <p>Checks to make sure Other Logon/Logoff Events Audit is active CSP</p> </li> <li> <p>Failed Login attempts via PIN at lock screen</p> <ul> <li>Error/Status code <code>0xC0000064</code> indicates wrong PIN entered at lock screen</li> </ul> </li> <li> <p>USB storage Connects &amp; Disconnects (Flash drives, phones etc.)</p> </li> </ul> </li> </ul> <p></p> <ul> <li> Enables WinVerifyTrust Signature Validation, a security feature related to WinVerifyTrust function that handles Windows Authenticode signature verification for portable executable (PE) files.</li> </ul> <p></p> <ul> <li> Enables Command line process auditing.  CSP</li> </ul> <p></p> <ul> <li> Enables the RPC Endpoint Mapper Client Authentication policy.  CSP</li> </ul> <p></p> <ul> <li> Enables a policy that requests claims and compound authentication for Dynamic Access Control and Kerberos armoring.  CSP</li> </ul> <p></p> <ul> <li>  Enables Windows Protected Print.  CSP</li> </ul> <p></p> <ul> <li> Configures the SSH client's configurations to use the following secure MACs (Message Authentication Codes): <code>MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com</code>.</li> </ul> <p></p> <ul> <li>  Enables support for long paths.</li> </ul> <p></p> <ul> <li> Force strong key protection for user keys stored on the computer. User is prompted when the key is first used.</li> </ul> <p></p> <ul> <li> <p>  Reduced Telemetry. This sub-category applies all of the policies mentioned below. They do not have any effect on security.</p> </li> <li> <p>Disable Online Tips.  CSP</p> </li> <li> <p>Disable Find My Device feature.  CSP</p> </li> <li> <p>Disable Automatic Update of Speech Data.  CSP</p> </li> <li> <p>Turn off the advertising ID.  CSP</p> </li> <li> <p>Turn off cloud optimized content.  CSP</p> </li> <li> <p>Do not show Windows tips.  CSP</p> </li> <li> <p>Do not show feedback notifications.  CSP</p> </li> <li> <p>Turn off Automatic Download and Update of Map Data.  CSP</p> </li> <li> <p>Disable Message Service Cloud Sync for cellular text messages.  CSP</p> </li> <li> <p>Disable support for web-to-app linking with app URI handlers.  CSP</p> </li> <li> <p>Disable \"Continue experiences on this device\" feature.  CSP</p> </li> <li> <p>Disable Font Providers.  CSP</p> </li> <li> <p>Don't search the web or display web results in Search.  CSP</p> </li> <li> <p>Do not allow web search. More Info</p> </li> </ul> <p></p> <p></p> <p></p>"},{"location":"#windows-update-configurations","title":"Windows Update Configurations","text":"<p>Windows updates are extremely important. They always should be installed as fast as possible to stay secure and if a reboot is required, it should be done immediately. Threat actors can weaponize publicly disclosed vulnerabilities the same day their POC (Proof-Of-Concept) is released..</p> <p>In Windows by default, devices will scan daily, automatically download and install any applicable updates at a time optimized to reduce interference with usage, and then automatically try to restart when the end user is away.</p> <p>The following policies the module configures make sure the default behavior explained above is tightly enforced.</p> <ul> <li> Enables Windows Update to download and install updates on any network, metered or not; because the updates are important and should not be suppressed, that's what bad actors would want. CSP</li> </ul> <p></p> <ul> <li> Enables \"Receive Updates for other Microsoft products\" (such as PowerShell)</li> </ul> <p></p> <ul> <li> Enables \"Notify me when a restart is required to finish updating\".  CSP</li> </ul> <p></p> <ul> <li> Specifies the number of days before quality updates are installed on devices automatically to 1 day.  CSP</li> </ul> <p></p> <ul> <li> Specifies the number of days before feature updates are installed on devices automatically to 1 day.  CSP</li> </ul> <p></p> <ul> <li> Sets the number of grace period days before feature updates are installed on devices automatically to 1 day.  CSP</li> </ul> <p></p> <ul> <li> Sets the number of grace period days before quality updates are installed on devices automatically to 1 day.  CSP</li> </ul> <p></p> <ul> <li> Configures the automatic updates to happen every day, automatically be downloaded and installed, notify users for restart.  CSP</li> </ul> <p></p> <ul> <li> Enables features introduced via servicing that are off by default so that users will be able to get new features after having Windows Update settings managed by Group Policy as the result of running this category.  CSP</li> </ul> <p></p> <p></p> <p></p>"},{"location":"#edge-browser-configurations","title":"Edge Browser configurations","text":"<ul> <li> Block 3rd party cookies - Recommendatory policy</li> </ul> <ul> <li> Set Edge to use system's DNS over HTTPS</li> </ul> <ul> <li> Automatic HTTPS upgrade of HTTP connections</li> </ul> <ul> <li> Enable Encrypted Client Hello</li> </ul> <ul> <li> Disable Basic HTTP authentication scheme</li> </ul> <ul> <li> Allow devices using this hardening category to receive new features and experimentations like normal devices</li> </ul> <ul> <li> Enforce the audio process to run sandboxed</li> </ul> <ul> <li> Sets the share additional operating system region setting to never - Recommendatory policy</li> </ul> <ul> <li> <p> Disables the following weak Cipher Suites</p> <ul> <li> <p>Site 1 to test TLS in your browser</p> </li> <li> <p>Site 2 to test TLS in your browser</p> </li> </ul> </li> </ul> <p></p> <ul> <li> Policy that automatically denies the window management permission to sites by default. This limits the ability of sites to see information about the device's screens and use that information to open and place windows or request fullscreen on specific screens.</li> </ul> <p></p> <ul> <li> <p> Policy that will keep support for Manifest V2 extensions enabled even after its depreciation. Manifest V2 extension support is vital for proper functioning of ublock origin (and similar extensions) which is beyond a simple adblocker and can provide lots of protection when browsing the web through its custom lists.</p> </li> <li> <p>Note that this is something being pushed by Google through their controlling power of Chromium, not Microsoft.</p> </li> </ul> <p></p> <ul> <li> Policy that will prevent websites to even request access to the local connected USB devices.</li> </ul> <p></p> <ul> <li> Policy that will disable dynamic code in Edge browser which is a security feature that prevents the browser process from creating dynamic code. The default value of this policy is not explicitly defined, it could be enable or could be disabled. Setting it explicitly to enabled via this policy ensures that no dynamic code is created by the browser process.</li> </ul> <p></p> <ul> <li> CSP</li> </ul> <pre><code>TLS_RSA_WITH_AES_256_CBC_SHA  Reason: NO Perfect Forward Secrecy, CBC, SHA1\nTLS_RSA_WITH_AES_128_CBC_SHA  Reason: NO Perfect Forward Secrecy, CBC, SHA1\nTLS_RSA_WITH_AES_128_GCM_SHA256  Reason: NO Perfect Forward Secrecy\nTLS_RSA_WITH_AES_256_GCM_SHA384  Reason: NO Perfect Forward Secrecy\nTLS_ECDHE_RSA_WITH_AES_128_CBC_SHA  Reason: CBC, SHA1\nTLS_ECDHE_RSA_WITH_AES_256_CBC_SHA  Reason: CBC, SHA1\n</code></pre> <p></p> <p>Due to security reasons, many policies cannot be used when you are signed into Edge browser using personal Microsoft account. This module does not use any of those policies. When those policies are applied, they are ignored by the browser and <code>edge://policy/</code> shows an error for them.</p> <p></p> <ul> <li>You can view all of the policies being applied to your Edge browser by visiting this page: <code>edge://policy/</code></li> <li>You can find all of the available internal Edge pages in here: <code>edge://about/</code></li> </ul> <p></p> <ul> <li>Useful links:<ul> <li>Microsoft Edge stable channel change log</li> <li>Microsoft Edge Security updates change log</li> <li>Microsoft Edge Beta channel change log</li> <li>Microsoft Edge Mobile stable channel change log</li> <li>Edge Insider for Beta/Dev/Canary channels</li> <li>Microsoft Edge Security baselines - Work without ingesting ADMX policy files first<ul> <li>Reason why the module doesn't use it.</li> </ul> </li> </ul> </li> </ul> <p></p> <p></p> <p></p>"},{"location":"#certificate-checking-commands","title":"Certificate Checking Commands","text":"<p> In this category, the module downloads and runs sigcheck64.exe from Sysinternals, then lists valid certificates not rooted to the Microsoft Certificate Trust List in the User and Machine certificate stores. Except for some possible Microsoft certificates, Windows insider builds certificates or certificates that have your own computer's name, which are perfectly safe and should not be deleted, All other certificates that will be listed should be treated as dangerous and removed from your system immediately.</p> <p></p> <p></p> <p></p>"},{"location":"#country-ip-blocking","title":"Country IP Blocking","text":"<p> The module uses the newest range of <code>IPv4</code> and <code>IPv6</code> addresses of State Sponsors of Terrorism and OFAC Sanctioned Countries, directly from official IANA sources repository, then creates 2 rules (inbound and outbound) for each list in Windows firewall, completely blocking connections to and from those countries.</p> <p>Once you have those Firewall rules added, you can use this method to see if any of the blocked connections were from/to those countries.</p> <p>Note</p> <p>Threat actors can use VPN, VPS etc. to mask their originating IP address and location. So don't take this category as the perfect solution for network protection.</p> <p></p> <p></p> <p></p>"},{"location":"#downloads-defense-measures","title":"Downloads Defense Measures","text":"<p> To combat the threat of more sophisticated malware, a preemptive measure is taken by creating and deploying an App Control policy on the system. This policy blocks the execution of executables and other potentially harmful file types in the Downloads folder.</p> <p>This policy defends the system from malware that can launch itself automatically after being downloaded from the Internet. The user must ensure the file's safety and explicitly transfer it to a different folder before running it.</p> <p>The App Control policy employs a wildcard pattern to prevent any file from running in the Downloads folder. Additionally, it verifies that the system downloads folder in the user directory matches the downloads folder in the Edge browser's settings. If there is a discrepancy, a warning message is displayed on the console.</p> <p></p> <p>  Creates a custom App Control policy that blocks the execution of the following executables:</p> <ul> <li>wscript.exe</li> <li>mshta.exe</li> <li>cscript.exe</li> </ul> <p>They are insecure, unsandboxed script hosts that pose a security risk.</p> <p></p> <p>All of the policies can be easily removed using the Unprotect-WindowsSecurity or AppControl Manager.</p> <p></p> <p></p> <p></p>"},{"location":"#non-admin-commands","title":"Non-Admin Commands","text":"<p>You don't need Admin privileges to run this category, because no system-wide changes is made. Changes in this category only apply to the current user account that is running the PowerShell session.</p> <ul> <li> Shows known file extensions in File explorer</li> </ul> <p></p> <ul> <li> Shows hidden files, folders and drives (toggles the control panel folder options item)</li> </ul> <p></p> <ul> <li> Disables websites accessing local language list - good for privacy</li> </ul> <p></p> <ul> <li> Turns off safe search in Windows search, will enable +18 content to appear in searches; essentially toggles the button in: Windows settings &gt; privacy and security &gt; search permissions &gt; safe search</li> </ul> <p></p> <ul> <li> Enables Clipboard History</li> </ul> <p></p> <ul> <li> Turns on text suggestions when typing on the physical keyboard</li> </ul> <p></p> <ul> <li> Turns on \"Multilingual text suggestions\" for the current user, toggles the option in Windows settings</li> </ul> <p></p> <ul> <li> Turns off sticky key shortcut of pressing shift key 5 times fast</li> </ul> <p></p> <ul> <li> Disables Show reminders and incoming VoIP calls on the lock screen</li> </ul> <p></p> <p></p> <p></p>"},{"location":"#related","title":"Related","text":"<p> Azure DevOps Repository (mirror)</p> <p> Harden Windows Security website</p> <p> Official global IANA IP block for each country</p> <p> Windows Security Blog</p> <p> WinSecureDNSMgr</p> <p> Privacy, Anonymity and Compartmentalization</p> <p></p> <p></p> <p></p>"},{"location":"#trust","title":"Trust","text":""},{"location":"#how-can-you-100-trust-this-repository-and-know-that-nothing-shady-is-going-on","title":"How can you 100% trust this repository and know that nothing shady is going on?","text":"<p>This repository uses effective methods that make it easy to verify:</p> <ul> <li> <p>Change log history is present on GitHub. (Despite some of my awkward documentation typos)</p> </li> <li> <p>Artifact attestations are used to establish provenance for builds. It guarantees that the package(s) you download from this repository are 100% created from the source code that exist in this repository.</p> </li> <li> <p>SBOMs (Software Bill of Materials) are generated for the entire repository to comply with data protection standards and providing transparency. Together with attestation they provide SLSA L2 security level for the build process. In the future, the workflows will be upgraded to comply with SLSA L3 level.</p> </li> <li> <p>You can open the files in Visual Studio Code / Visual Studio Code Web / GitHub CodeSpace, and view them in a nice and easy to read environment, they are well formatted, commented and indented.</p> </li> <li> <p>Commits are verified either with my GPG key or SSH key and Vigilant mode is turned on in my GitHub account.</p> </li> <li> <p>You can fork this repository, verify it until that point in time, then verify any subsequent changes/updates I push to this repository, at your own pace (using <code>Sync fork</code> and <code>Compare</code> options on your fork), and if you are happy with the changes, allow it to be merged with your own copy/fork on your GitHub account.</p> </li> <li> </li> <li> <p>How Are Group Policies Used by the Harden Windows Security Module?</p> </li> <li>How are Group Policies for this module created and maintained?</li> <li>How to verify Security-Baselines-X directory and 100% trust it?</li> </ul> <p></p> <p>Tip</p> <p>All files in this repository are zipped and automatically submitted to VirusTotal for scanning. Any available packages in the last release is also directly uploaded for scanning. It is done through a GitHub Action that is triggered every time a release is made or a PR is merged. Find the history of the uploaded files in my Virus Total profile.</p> <ul> <li></li> <li></li> <li></li> <li></li> <li></li> <li></li> <li></li> <li></li> </ul> <p></p> <p></p> <p></p>"},{"location":"#explanations-for-some-of-the-files-used-by-the-harden-windows-security-module-ask-about-any-other-files-if-you-have-questions-they-are-all-in-clear-text","title":"Explanations for some of the files used by the Harden Windows Security module, ask about any other file(s) if you have questions, they are all in clear text.","text":"<ul> <li> <p>Registry.csv includes some of the security measures' registry data.</p> </li> <li> <p>ProcessMitigations.csv includes the process mitigations data.</p> </li> <li> <p>Default Security Policy.inf contains security policy data used during unprotect actions to restore defaults.</p> </li> <li> <p>Registry resources.csv Includes the data used for compliance checking.</p> </li> <li> <p>Harden-Windows-Security.ps1 is the boot-strapper for the Harden Windows Security module.</p> </li> </ul>"},{"location":"#support","title":"Support","text":"<p> If you have any questions, requests, suggestions etc. about this GitHub repository and its content, please open a new discussion or Issue.</p> <p> Reporting a vulnerability on this GitHub repository.</p> <p> I can also be reached privately at: spynetgirl@outlook.com</p> <p></p> <p></p> <p></p>"},{"location":"#security-recommendations","title":"Security Recommendations","text":"<ul> <li> <p> Always download your operation system from official Microsoft websites. Right now, Windows 11 is the latest version of Windows, its ISO file can be downloaded from this official Microsoft server. One of the worst things you can do to your own security and privacy is downloading your OS, which is the root of all the active and passive security measures, from a 3rd party website claiming they have the official unmodified files. There are countless bad things that can happen as the result of it such as threat actors embedding malware or backdoors inside the customized OS, or pre-installing customized root CA certificates in your OS so that they can perform TLS termination and view all of your HTTPS and encrypted Internet data in plain clear text, even if you use VPN. Having a poisoned and compromised certificate store is the endgame for you, and that's just the tip of the iceberg.</p> <ul> <li>Refer to Wiki to see how to create Bootable USB flash drive with no 3rd party tools</li> </ul> </li> </ul> <p></p> <ul> <li> <p> Whenever you want to install a program or app, first use the Microsoft Store or Winget, if the program or app you are looking for isn't available in there, then download it from its official website. Somebody created a nice web interface for interacting with Winget CLI here. Using Winget or Microsoft store provides many benefits:</p> <ul> <li> <p>Microsoft store UWP apps are secure in nature, digitally signed, in MSIX format. That means, installing and uninstalling them is guaranteed and there won't be any leftovers after uninstalling.</p> </li> <li> <p>Microsoft store has Win32 apps too, they are traditional <code>.exe</code> installers that we are all familiar with. The store has a library feature that makes it easy to find the apps you previously installed.</p> </li> <li> <p>Both Microsoft and Winget check the hash of the files by default, if a program or file is tampered, they will warn you and block the installation, whereas when you manually download a program from a website, you will have to manually verify the file hash with the hash shown on the website, if any.</p> </li> </ul> </li> </ul> <p></p> <ul> <li> <p> Use Secure DNS; Windows 11 natively supports DNS over HTTPS and DNS over TLS.</p> <ul> <li>Use my WinSecureDNSMgr module to easily configure DNS over HTTPS in Windows</li> </ul> </li> </ul> <p></p> <ul> <li> Only use Microsoft Edge for browser; It has the Highest-rated protection against phishing and malware, available by default on Windows OS, has tightly integrated valuable Security features such as Microsoft Defender Application Guard, Microsoft Defender SmartScreen, Hardware Enforced Stack Protection, Arbitrary Code Guard (ACG), Control Flow Guard (CFG), Tracking Prevention and Trusted built-in Secure Network feature from Cloudflare just to name a few. <p></p> <ul> <li> Always enable Two-Factor/Multi-Factor Authentication on websites, apps and services that you use. Preferably, use Microsoft Authenticator app which has backup and restore feature, so you never lose access to your TOTPs (Time-Based One-Time Passwords) even if you lose your phone. Available for Android and IOS.</li> </ul> <p></p> <ul> <li> Make sure OneDrive backup for important folders (Desktop/Documents/Pictures) is enabled. It is fast, secure and works in any network condition and since it's x64 (64-bit), it can handle a Lot of small and large files simultaneously.</li> </ul> <p></p> <ul> <li> <p> When considering the use of a VPN, it is crucial to exercise discernment and only resort to it when absolutely necessary. A VPN can be a vital tool if you reside in a totalitarian, communist, or dictatorial regime, or in a nation where democratic principles are not upheld. However, if you live in a country that does not fall into these categories, it may be wise to reconsider the necessity of using a VPN. Your local ISP (Internet Service Provider) is likely more trustworthy than the ISP associated with a remote VPN server. By using a VPN, you are merely transferring the trust you place in your local ISP to an unknown entity\u2014the ISP utilized by the VPN provider. It is important not to be swayed by the deceptive marketing tactics employed by VPN companies. The true identities, political affiliations, backgrounds, and loyalties of those behind these services often remain shrouded in mystery. In the permissive and open societies of the Western world, it is conceivable that a VPN service could be established by entities with questionable intentions, including state sponsors of terrorism or other hostile actors. Such services could be utilized to gather intelligence, conduct data mining, and track users, posing significant risks to your privacy and security.</p> <ul> <li>There are situations where using VPN can provide security and privacy. For example, when using a public WiFi hotspot or basically any network that you don't have control over. In such cases, use Cloudflare WARP which uses WireGuard protocol, or as mentioned, use Secure Network in Edge browser that utilizes the same secure Cloudflare network. It's free, it's from an American company that has global radar and lots of insight about countries in the world in real-time, at least 19.7% of all websites use it (2022). Safe to say it's one of the backbones of the Internet.</li> </ul> </li> </ul> <p></p> <ul> <li> Go passwordless with your Microsoft account and use Windows Hello authentication. In your Microsoft account which has Outlook service, you can create up to 10 Email aliases in addition to the 1 Email address you get when you made your Microsoft account, that means without creating a new account, you can have 11 Email addresses all of which will use the same inbox and account. You can specify which one of those Email aliases can be used to sign into your account, in the sign in preferences of your Microsoft account settings. So for example, when going passwordless, if you need you can give one of your Email aliases to others for communication or add it to a public profile of yours, then block sign in using that Email alias so nobody can send you authenticator notifications by entering that Email alias in the sign in page, and use the other 10 aliases that are private to sign into your Microsoft account with peace of mind. You can create a rule in your Outlook so that all of the Emails sent to your public Email alias will be stored in a different folder, apart from your other inbox emails. All of this can be done using free Microsoft account and Outlook webapp.</li> </ul> <p></p> <ul> <li> Set a strong password for the UEFI firmware of your device so that it will ask for password before allowing any changes to be made to firmware. You can also configure the password to be required on startup.</li> </ul> <p></p> <ul> <li> Use NTFS (which is the default Filesystem in Windows) or ReFS (Resilient File System, newer). In addition to all their benefits, they support <code>Mark Of The Web</code> (MOTW) or <code>zone.identifier</code>. When a file is downloaded to a device running Windows, Mark of the Web is added to the file, identifying its source as being from the internet. You can read all the information about it in here. If your USB flash drive is formatted as <code>FAT32</code>, change it to <code>NTFS</code>, because <code>FAT32</code> does not keep the <code>MOTW</code> of the files. If the file you are downloading is compressed in <code>.zip</code> format, make sure you open/extract it using Windows built-in support for <code>.zip</code> files because it keeps the MOTW of the files. If the compressed file you downloaded is in other formats such as <code>.7zip</code> or <code>.rar</code>, make sure you use an archive program that supports keeping the mark of the Web of files after extraction. One of those programs is NanaZip which is a fork of 7zip, available in Microsoft Store and GitHub, compared to 7zip, it has better and modern GUI, and the application is digitally signed. After installation, open it, navigate to <code>Tools</code> at the top then select <code>Options</code>, set <code>Propagate zone.id stream</code> to <code>Yes</code>. You can use this PowerShell command to find all the info about the Zone Identifier of the files you downloaded from the Internet.</li> </ul> <pre><code>Get-Content &lt;Path-To-File&gt; -stream zone.identifier\n</code></pre> <p></p> <ul> <li> When using Xbox, make sure you configure sign-in preference and set it to either <code>Ask for my PIN</code> or <code>Lock it down</code>. The latter is the most secure one since it will require authentication using Microsoft Authenticator app. <code>Ask for my PIN</code> is recommended for the most people because it will only require a PIN to be entered using controller.</li> </ul> <p></p> <ul> <li> <p> A few reminders about open source programs:</p> <ul> <li> <p>Unless you are a skilled programmer who can understand and verify every line of code in the source, and spends time to personally build the software from the source, and repeats all the aforementioned tasks for each subsequent version, then seeing the source code won't have any effect on you because you aren't able to understand nor verify it.</p> </li> <li> <p>Do not assume that the entire Open Source community audits and verifies every line of code just because the source code is available, as we've seen in the XZ utility's backdoor by state sponsored actors, they can have backdoors implanted in them in broad daylight and nobody might notice it for a long time.</p> </li> <li> <p>The majority of open source programs are unsigned, meaning they don't have a digital signature, their developers haven't bought and used a code signing certificate to sign their program. Among other problems, this might pose a danger to the end-users by making it harder to create trust for those programs in security solutions such as Application Control or App Whitelisting, and makes it hard to authenticate them. Read Microsoft's Introduction to Code Signing. Use Azure Trusted Signing which is affordable.</p> </li> </ul> </li> </ul> <p></p> <ul> <li> Use Microsoft account (MSA) or Microsoft Entra ID to sign into Windows. Never use local administrators. Real security is achieved when there is no local administrator and identities are managed using Entra ID. You will be able to enforce Multi-factor unlock, for example use PIN + Fingerprint or PIN + Facial recognition, to unlock your device.</li> </ul> <p></p> <ul> <li> Enable Random Hardware Addresses In Windows Settings -&gt; Network &amp; Internet -&gt; WIFI. Currently, there is no Group Policy or associated registry key to automatically turn it on, that is why it is mentioned here in the security recommendations section. It has various security and privacy benefits such as your device cannot be uniquely identified by its hardware Mac address and the routers your connect to cannot uniquely identify you. You can set it to change daily in your WIFI network adapter's settings in Windows settings for even more benefits.</li> </ul> <p></p> <ul> <li> More Security Recommendations coming soon...</li> </ul> <p></p> <p></p> <p></p>"},{"location":"#resources","title":"Resources","text":"<ul> <li>Microsoft.com<ul> <li>Force firmware code to be measured and attested by Secure Launch</li> </ul> </li> <li>Microsoft Learn - Technical Documentation<ul> <li>Secure Launch\u2014the Dynamic Root of Trust for Measurement (DRTM)</li> <li>Quick guide to Windows as a service</li> </ul> </li> <li>Germany Intelligence Agency - BND - Federal Office for Information Security<ul> <li>Analysis of Device Guard</li> <li>Device Guard Differential Analysis</li> </ul> </li> <li>Microsoft Tech Community - Official blogs and documentations</li> <li>Microsoft Security baselines - Security baselines from Microsoft</li> <li>Microsoft Security Response Center (MSRC) YouTube channel<ul> <li>BlueHat Seattle 2019 || Guarding Against Physical Attacks: The Xbox One Story</li> <li>Security Update Guide: The Microsoft Security Response Center (MSRC) investigates all reports of security vulnerabilities affecting Microsoft products and services, and provides the information here as part of the ongoing effort to help you manage security risks and help keep your systems protected.</li> <li>Microsoft Security Response Center Blog</li> </ul> </li> <li>Microsoft Security Blog</li> <li>Microsoft Podcasts</li> <li>Bug Bounty Program - With bounties worth up to <code>250,000</code>$</li> <li>Microsoft Active Protections Program</li> <li>Security Update Guide FAQs</li> <li>Microsoft On the Issues - Assessments, Investigations and Reports of APTs (Advanced Persistent Threats\u00b9) and nation-sponsored cyberattack operations globally</li> <li>A high level overview paper by Microsoft (in <code>PDF</code>), framework for cybersecurity information sharing and risk reduction.</li> <li>Microsoft Threat Modeling Tool - for software architects and developers</li> <li>Important events to monitor</li> <li>Windows Security portal</li> <li>Security auditing</li> <li>Microsoft SysInternals Sysmon for Windows Event Collection or SIEM</li> <li>Privileged Access Workstations</li> <li>Enhanced Security Administrative Environment (ESAE)</li> <li>New Zealand 2016 Demystifying the Windows Firewall \u2013 Learn how to irritate attackers without crippli</li> <li>Download Windows virtual machines ready for development</li> <li>UK National Cyber Security Centre Advice &amp; guidance</li> <li>Global threat activity</li> <li>Microsoft Zero Trust</li> <li>Understanding malware &amp; other threats, phrases</li> <li>Malware naming</li> <li>Microsoft Digital Defense Report</li> <li>Microsoft Defender for Individuals</li> <li>Submit a file for malware analysis</li> <li>Submit a driver for analysis</li> <li>Service health status</li> <li>Microsoft Defender Threat Intelligence<ul> <li>Free community edition vs Premium edition comparison</li> </ul> </li> <li>Microsoft Virus Initiative</li> <li>Digital Detectives @Microsoft</li> <li>Australia's Essential Eight</li> <li>NIST 800-53</li> <li>DoD's CMMC (Cybersecurity Maturity Model Certification)</li> <li>ISO 27001</li> <li>DoD Cyber Stigs (Security Technical Implementation Guides)</li> <li>NIST SP 800-171 Rev. 2 - Protecting Controlled Unclassified Information in Nonfederal Systems and Organizations</li> <li>Clean source principle</li> <li>Windows Message Center</li> <li>Deprecated features for Windows client</li> <li>Microsoft Cybersecurity Reference Architectures</li> <li>BlueHat IL 2023 - David Weston - Default Security</li> <li>Windows Security best practices for integrating and managing security tools</li> <li>Microsoft Exploitability Index</li> <li>The Microsoft Incident Response Ninja Hub</li> <li>Understanding the Microsoft Pluton security processor</li> </ul>"},{"location":"#roadmap","title":"Roadmap","text":""},{"location":"#license","title":"License","text":"<p>Using MIT License. Free information without any paywall or things of that nature. The only mission of this GitHub repository is to give all Windows users accurate, up to date and correct facts and information about how to stay secure and safe in dangerous environments, and to stay not one, but Many steps, ahead of threat actors.</p>"},{"location":"#credits","title":"Credits","text":"<ul> <li>Some of the icons are from icons8</li> <li>Windows, Azure etc. are trademarks of Microsoft Corporation</li> </ul>"},{"location":"#donations","title":"Donations","text":"<p>If you would like to support my work financially, your generosity is greatly appreciated. This section is specifically for those who want to make a monetary contribution. There are other ways to support such as sharing the repository on social media, starring and so on.</p> <p>You can donate using the following methods:</p> <ul> <li> <p>Donate to a Charity That Matters: Instead of donating directly to me, you could donate to a charity that is important to me, one that works to keep us safe and alive: FIDF</p> </li> <li> <p>Donate to me personally: My Public Address to Receive BNB (Smart Chain - Coin)</p> </li> </ul>  Click/Tap here to view QR code   <pre><code>0xF784a3D4F9A7CC5c26d69de41D7dD6480112114D\n</code></pre> <p></p> <p></p> <p></p>"},{"location":"Rationale/","title":"Rationale","text":"<p>This document provides the justification and objective of this GitHub repository and its contents. It outlines how it addresses various threats and how to adjust your expectations for different scenarios and environments. It also supplies lots of useful additional resources.</p> <p>This repository currently has 2 main products. </p> <ol> <li>The Harden Windows Security module</li> <li>The AppControl Manager</li> </ol> <p></p> <p>Let's explore each of them in detail below</p> <p></p>"},{"location":"Rationale/#harden-windows-security-module","title":"Harden Windows Security Module","text":"<p>Use the Harden Windows Security module to secure your personal and enterprise devices against the majority of advanced threats. The module is suitable to be used by everyone.</p> <p>If you are a personal user, you can use the Harden Windows Security to harden your Operation System, remove unnecessary features, apps and so on, check its security score or undo the hardening measures.</p> <p>If you are an enterprise user or admin, you can use the provided Intune security policies from this repository and apply them from your Intune Portal to all of your workstations using Microsoft Graph API. You can then use the module to verify the compliance of the workstations against the applied policies and receive a security score.</p> <p>It uses the same security features built into your device and Windows operating system to fine-tune it towards the highest security and locked-down state. It does not install any outside components and does not increase your attack surface at all.</p> <p>Let's Take a look at the infographics below:</p> <p></p> <p></p> <p>More Info About This Map</p> <p></p> <p></p> <p></p> <p>The reasoning behind the infographic above</p> <p></p>"},{"location":"Rationale/#appcontrol-manager","title":"AppControl Manager","text":"<p>AppControl Manager is a secure open-source Windows application designed to help you easily configure Application Control in your system. It is suitable for both personal users as well as enterprises, businesses and highly secure workstations.</p> <p>Tip</p> <p>If you aren't familiar with what App Control is, please refer to this article where it's explained in great detail.</p> <p>Proper usage of Application Control, when coupled with the Harden Windows Security module's policies, can provide 99% protection from various threats, either from the Internet or physical. It's true that there is no absolute security, but then again there is nothing absolute in the universe either. Everything, even the most fundamental physical laws, are and have been subject to change and conditions.</p> <ul> <li> <p>Here is a walkthrough video of the AppControl Manager</p> </li> <li> <p>Here is the AppControl Manager's landing page on this repository</p> </li> </ul> <p></p>"},{"location":"Rationale/#how-do-you-make-the-right-choice","title":"How Do You Make the Right Choice?","text":"<p>First use the Harden Windows Security Module to apply the hardening measures described in the Readme. After applying these hardening measures, your system will be secure against at least ~98% of the threats when you use Standard (non-Privileged) account for everyday work. These threats aren't the usual computer viruses, they are motivated nation state threat actors.</p>"},{"location":"Rationale/#if-you-want-even-more-security-and-control-you-have-at-least-2-more-options","title":"If you want even more security and control, you have at least 2 more options:","text":"<ol> <li> <p>you can either use Smart App Control, which deploys an automatic and AI based App Control policy that uses Intelligent Security Graph to authorize safe and reputable applications and files and blocks unknown and malicious files.</p> </li> <li> <p>Use AppControl Manager to deploy an App Control policy and have even more control over the operation of the Windows Application Control.</p> </li> </ol> <p>These methods will create multiple layers of security; also known as defense in depth. Additionally, you can create Kernel-level Zero-Trust strategy for your system.</p> <p>If there will ever be a zero-day vulnerability in one or even some of the security layers at the same time, there will still be enough layers left to protect your device. It's practically impossible to penetrate all of them at once.</p> <p>Also, zero-day vulnerabilities are patched quickly, so keeping your device and OS up to date, regardless of what OS you use, is one of the most basic security recommendations and best practices you must follow.</p> <p></p>"},{"location":"Rationale/#vulnerabilities-such-as-zero-days-are-disclosed-in-3-different-ways","title":"Vulnerabilities Such as Zero-Days Are Disclosed in 3 Different Ways","text":"<ol> <li> <p>The vulnerability is disclosed responsibly. It is first communicated privately with the software vendor/developer so they can have the time to fix and issue updates/patches for the vulnerability before it is disclosed publicly. In this way, people are always safe because all that's needed is to keep your OS and software up to date to receive the latest security patches.</p> </li> <li> <p>The vulnerability is disclosed irresponsibly. It is disclosed publicly, through social media or by creating PoCs (Proof of Concept) so that it can be used and abused by everyone.</p> </li> <li> <p>The vulnerability is abused by malicious actors. It is exploited by threat actors in cyber attacks and privately. These vulnerabilities are either discovered by the threat actors themselves or bought from security researchers who find them first, all of which is illegal and has consequences.</p> </li> </ol> <p></p>"},{"location":"Rationale/#what-about-more-advanced-security-at-scale","title":"What About More Advanced Security at Scale ?","text":"<p>To achieve the Highest level of Security at Scale for Businesses, Enterprises and Military scenarios, you can use the following services to create impenetrable devices and environments.</p> <p>Important</p> <p>The following services must be used in addition to the measures already talked about in this repository, such as proper Application Control policies and the security measures that the Harden Windows Security module applies. They are not a replacement for them.</p> <p>As an individual user you can still utilize these features and services, they add an additional layer of protection to your security stack.</p> <ul> <li> <p>Microsoft Defender for Endpoint - Discover and secure endpoint devices across your multiplatform enterprise.</p> </li> <li> <p>Microsoft Security Copilot - Build a defense so automated that even your intern becomes a cybersecurity expert.</p> </li> <li> <p>Confidential Computing on Azure - Protect your highly sensitive data while it's in use</p> </li> <li> <p>Confidential AI - Train your data Privately and Securely on the most advanced AI Super computers</p> </li> <li> <p>Microsoft Entra conditional access - Increase protection without compromising productivity</p> </li> <li> <p>Microsoft Sentinel - Scalable, cloud-native solution that provides SIEM, SOAR and more!</p> </li> <li> <p>Key Vault - Safeguard cryptographic keys and other secrets used by cloud apps and services. This Azure service uses the best products in the world for the job, such as Thales HSMs. More info available here.</p> </li> <li> <p>Microsoft Defender for Cloud - Protect multicloud and hybrid environments with integrated security from code to cloud</p> </li> <li> <p>Microsoft Defender for Cloud Apps - Modernize how you secure your apps, protect your data, and elevate your app posture with software as a service (SaaS) security.</p> </li> <li> <p>Microsoft Defender for Identity - Protect your on-premises identities with cloud-powered intelligence.</p> </li> <li> <p>Passwordless authentication options for Azure Active Directory - Multifactor and Passwordless Authentication, the most secure and convenient way of authentication.</p> </li> <li> <p>PIM (PAM) - Privileged Access Management</p> </li> <li> <p>PAW - Privileged Access Workstation</p> </li> <li> <p>SAW - Secure Admin Workstations</p> </li> <li> <p>List of all Azure security services for Enterprises, Businesses etc.</p> </li> </ul> <p></p>"},{"location":"Rationale/#important-considerations","title":"Important Considerations","text":"<ul> <li> <p>Avoid using any 3rd party security solutions when using Harden Windows Security module or App Control for Business. 3rd party solutions are weak, incompatible and unnecessary, they also increase your attack surface.</p> </li> <li> <p>Use Virtual machines for any questionable or unsafe software. Use Windows Sandbox or Hyper-V VM. Also consider using Virtual machines or Microsoft Defender Application Guard (MDAG) for browsing on highly secure workstations.</p> </li> </ul> <p></p>"},{"location":"Rationale/#which-device-to-use","title":"Which Device to Use ?","text":"<p>Use Microsoft Surface products for the best device and firmware security. They support secured-core PC specifications, the manufacturing process and platform is trusted and secure.</p> <p>Make sure to use Surface products that support Device Firmware Configuration Interface (DFCI) for extra protection and security. Here is a list of Surface products that support it.</p> <ul> <li> <p>How to use Device Firmware Configuration Interface (DFCI) for Surface Devices with Intune</p> </li> <li> <p>Among other features, devices set up with DFCI can be set that boot from USB device(s) is disabled and there is no way to bypass the chip level security directly, not even CMOS clear can bypass it, because it uses non-volatile memory aka flash storage. It sets BIOS cert authentication, and the private key is behind the cloud edge inside Intune and not even Microsoft support can get that key.</p> </li> <li> <p>The list of Surface products supporting DFCI might not get updated quickly in that doc but fear not, this is an active project and all new surface devices have this built in, the docs team might be just a little laggy.</p> </li> <li> <p>Microsoft Surface devices use Project Mu for the source code of their firmware.</p> </li> <li> <p>Surface devices can use certificates instead of password for UEFI. They don't have a reset switch like other devices either. You create and install your own certificate using Surface Management Toolkit. You can build a config package that has the certificate in it and install it to the firmware, then the package can't be removed or changed without the signing cert authorizing the change, aka, cert auth, or you can just use DFCI as previously mentioned and not have to worry because the packages are signed with MS's private key and there is no PKI that you have to self host.</p> </li> <li> <p>Business class Surface devices have dedicated TPM chips.</p> </li> <li> <p>Check out the Device Guard category about Secured-Core specifications.</p> </li> <li> <p>Pluton security chip is not a requirement for Secured-Core certification.</p> </li> <li> <p>Pluton security chip is included in Qualcomm Snapdragon ARM CPUs, AMD and Intel CPUs.</p> </li> </ul> <p></p> <p>Important</p> <p> It is important to be aware of potential hardware backdoors that may compromise the security of your system. Some common OEMs, such as Compaq, Dell, Fujitsu, Hewlett-Packard (HP), Sony, and Samsung, with OEMs that use unmodified Insyde H20, or Phoenix firmwares utilize algorithms based on device serial numbers for password resets. These algorithms allow for master password removal from the firmware, potentially granting unauthorized access to the system.</p> <p></p> <p>Note</p> <p> When buying 3rd party devices, make sure they have the Pluton security chip, it addresses security needs like booting an operating system securely even against firmware threats and storing sensitive data safely even against physical attacks.</p> <p></p>"},{"location":"Rationale/#protection-against-byovd-bring-your-own-vulnerable-driver-attacks","title":"Protection against BYOVD (Bring Your Own Vulnerable Driver) attacks","text":"<ul> <li> <p>Secured core PCs provide the hardware that is capable of protecting against BYOVD attacks. It is your responsibility to turn the features on, those include App Control for Business, ASR (Attack Surface Reduction) rules, Dynamic/static root of trust and firmware that is extensible for revoking drivers. They are specially useful for drivers not explicitly mentioned in the Microsoft Recommended Driver Block List, which are the more dynamic side of things.</p> </li> <li> <p>Use Strict Kernel-mode App Control policy for complete BYOVD protection</p> </li> </ul> <p></p>"},{"location":"Rationale/#what-to-do-when-there-is-an-attack","title":"What to Do When There Is an Attack ?","text":"<p>You should have an existing Unified Contract with Microsoft (formerly known as Premier Support). Microsoft offers a wide range of services and teams to help you recover from a cyber attack such as:</p> <ul> <li>GHOST: Global Hunting, Oversight and Strategic Triage</li> <li>DART - The Microsoft Detection and Response Team</li> <li>CRSP - Global Compromise Recovery Security Practice Team - including Ransomware</li> </ul> <p>After you've got hacked, you should request them by contacting your Customer Success Account Manager and telling them you need the help of one of these teams.</p> <p></p> <p>Tip</p> <p>When getting cyber security insurance for your company or organization, make sure to get one that covers the cost of hiring Microsoft's elite teams such as GHOST/DART, i.e. those Microsoft teams will be in-network for your insurance.</p> <p></p>"},{"location":"Rationale/#color-breakdown-of-security-teams-in-organizations","title":"Color breakdown of security teams in organizations","text":"<ul> <li>\ud83d\udd34 Red - Pen Testers/White Hat Hackers</li> <li>\ud83d\udd35 Blue - SOC/Data Science/Telemetry Analysis/SIEM Junkies</li> <li>\ud83d\udfe2 Green - Fixers, takes input from blue and red and builds the fixes that are needed for identified blind spots (blue) or vulnerability/risk (red)</li> <li>\ud83d\udfe1 Yellow - Tooling, SWE to build new stuff for all of the above to operate faster and more effectively</li> </ul>"},{"location":"Rationale/#for-penetration-testing-and-benchmarking","title":"For Penetration testing and benchmarking","text":"<p>How to properly perform a pentest and benchmark a system hardened by this repository and make it as close to a real-world scenario as possible:</p> <ol> <li>Use a physical machine if possible, it should have Windows 11 certified hardware, Standard user account.</li> <li> <p>If you can't use a physical machine, use Hyper-V hypervisor. Your host (aka physical machine) must have Windows 11 certified hardware and meet all the hardware and UEFI security requirements explained in the Readme. VMs however are prone to side channel attacks, so don't use that attack vector in pentests if you want more realistic results.</p> </li> <li> <p>First apply the Harden Windows Security module (All categories of it) and then use the AppControl Manager to deploy a suitable Signed App Control policy.</p> </li> </ol> <p></p> <p>Important</p> <p>Always Pay attention to the Microsoft Security Servicing Criteria for Windows, specially the Security boundaries. There is no security boundary between Administrator to Kernel.</p> <p>Some penetration testers overlook this fact, assuming it is a vulnerability that they can perform administrative tasks such as disabling security features as Administrator. This is an expected behavior. Administrators have the power to control the security of a device and can disable security features at their discretion. This is why you need to use a Standard user account when performing a realistic penetration test.</p> <p>Another aspect to consider is the ambiguity in the word \"Admin\". There are at least two distinct types of Admins: Local Admin and Cloud Admin. For instance, when you are penetration testing a system that leverages enterprise cloud security solution such as Microsoft Defender for Endpoint (MDE), Admin access should be regarded as Cloud Admin since those devices use Microsoft Entra ID and lack Local Admin. In this situation, Cloud Admin can effortlessly disable security features as expected, rendering a pentest using Local Admin access utterly pointless. Conversely, when pentesting a system that only relies on personal security features such as Microsoft Defender, then Admin should be treated as Local Admin. In this case, the Admin can also disable any security feature for the same reasons stated above.</p> <p>Of course, Microsoft employs additional security measures such as Protected Process Light (PPL) for Defense in Depth strategies, but they do not alter the facts stated above. The goal is to always hope for the best, plan for the worst.</p> <p></p>"},{"location":"Rationale/#any-questions-or-suggestions","title":"Any questions or suggestions?","text":"<p>Please open a new issue or discussion in the repository.</p> <p></p>"}]}